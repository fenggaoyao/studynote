{"version":3,"file":"index.js","mappings":"mBACA,IAAIA,EAAsB,CCA1B,EAAwB,CAACC,EAASC,KACjC,IAAI,IAAIC,KAAOD,EACXF,EAAoBI,EAAEF,EAAYC,KAASH,EAAoBI,EAAEH,EAASE,IAC5EE,OAAOC,eAAeL,EAASE,EAAK,CAAEI,YAAY,EAAMC,IAAKN,EAAWC,MCJ3E,EAAwB,CAACM,EAAKC,IAAUL,OAAOM,UAAUC,eAAeC,KAAKJ,EAAKC,GCClF,EAAyBT,IACH,oBAAXa,QAA0BA,OAAOC,aAC1CV,OAAOC,eAAeL,EAASa,OAAOC,YAAa,CAAEC,MAAO,WAE7DX,OAAOC,eAAeL,EAAS,aAAc,CAAEe,OAAO,M,mCCDvD,MAAMC,EAAS,CAGfA,YAAqB,CAACC,EAAeC,KACnC,GAAID,EACF,OAAQA,GACN,IAAK,MACL,IAAK,OACL,IAAK,MACL,IAAK,MACL,IAAK,OACL,IAAK,MACL,IAAK,MACH,MAAO,QACT,IAAK,KACH,MAAO,KACT,IAAK,MACH,MAAO,MACT,IAAK,OACH,MAAO,OACT,IAAK,OACL,IAAK,QACL,IAAK,MACL,IAAK,MACL,IAAK,MACH,MAAO,OACT,IAAK,MACH,MAAO,QACT,IAAK,MACH,MAAO,aAGb,GAAIC,EACF,OAAQA,GACN,IAAK,iBACH,MAAO,OACT,IAAK,MACH,MAAO,QACT,IAAK,SACH,MAAO,KACT,IAAK,WACL,IAAK,SACH,MAAO,OACT,QACE,MAAO,QAGb,OAAOA,GAGTF,eAAwB,CAACG,EAAcC,EAAgBC,KACrD,MAAMC,EAAQ,CACZH,GAAgB,mBAChBC,GAAkB,mBAClBC,GAAiB,oBAEnB,IAAIE,EAAQ,IACVC,EAAI,EAEN,IAAK,IAAIC,EAAI,EAAGA,EAAI,EAAGA,IACrBD,EAAIE,KAAKC,MAAMF,EAAI,GACnBF,GAASD,EAAME,GAAGI,MAAM,IAAIF,KAAKC,MAAMD,KAAKG,SAAWP,EAAME,GAAGM,SAElE,OAAOP,GAGTP,SAAkB,CAACe,EAAKC,KACsC,IAArDD,EAAIE,QAAQD,EAAQD,EAAID,OAASE,EAAOF,SAUjDd,EAAOkB,6BAA+B,CACpCC,EACAC,EACAC,KAEA,IAAIC,EAASF,GAAkB,UAG/B,OAAQD,GACN,IAAK,MACHG,EAAS,UACT,MACF,IAAK,SACL,IAAK,OACHA,EAAS,UACT,MACF,IAAK,MACL,IAAK,QACHA,EAAS,UACT,MACF,IAAK,SACL,IAAK,KACHA,EAAS,UACT,MACF,IAAK,OACHA,EAAS,UACT,MACF,IAAK,MACHA,EAAS,UACT,MACF,IAAK,OACHA,EAAS,UACT,MACF,IAAK,iBACL,IAAK,OACHA,EAAS,UAGb,OAAkB,IAAdD,EA7CqB,EAACE,EAAWF,IAI9B,KAHIG,SAASD,EAAUE,OAAO,EAAG,GAAI,IAAMJ,GAAWK,SAAS,KAC/DF,SAASD,EAAUE,OAAO,EAAG,GAAI,IAAMJ,GAAWK,SAAS,KAC3DF,SAASD,EAAUE,OAAO,EAAG,GAAI,IAAMJ,GAAWK,SAAS,IA2CzDC,CAAmBL,GAAS,GAE9BA,GAKTtB,EAAO4B,aAAe,CAACC,EAAKC,KAC1B,IAEEtC,EAFEuC,EAAS,GACXC,EAAY,GAGdH,EAAII,SAAS/C,IACX6C,EAAO7C,GAAO6C,EAAO7C,GAAO6C,EAAO7C,GAAO,EAAI,KAIhD,IAAK,IAAIgD,KAAMH,EACbvC,EAAM,GACNA,EAAIsC,GAAW,OAASI,EACxB1C,EAAI2C,MAAQJ,EAAOG,GAEnBF,EAAUI,KAAK5C,GAEjB,OAAOwC,EAAUK,MAAK,CAACC,EAAGC,IACjBD,EAAEH,MAAQI,EAAEJ,MAAQ,GAAK,KAIpCnC,EAAOwC,MAAShD,IACd,IAAIiD,EAGJ,GAAI,MAAQjD,GAAO,iBAAmBA,EAAK,OAAOA,EAGlD,GAAIA,aAAekD,KAGjB,OAFAD,EAAO,IAAIC,KACXD,EAAKE,QAAQnD,EAAIoD,WACVH,EAIT,GAAIjD,aAAeqD,MAAO,CACxBJ,EAAO,GACP,IAAK,IAAIhC,EAAI,EAAGqC,EAAMtD,EAAIsB,OAAQL,EAAIqC,EAAKrC,IACzCgC,EAAKhC,GAAKT,EAAOwC,MAAMhD,EAAIiB,IAE7B,OAAOgC,EAIT,GAAIjD,aAAeJ,OAAQ,CACzBqD,EAAO,GACP,IAAK,IAAIM,KAAQvD,EACXA,EAAIG,eAAeoD,KAAON,EAAKM,GAAQ/C,EAAOwC,MAAMhD,EAAIuD,KAE9D,OAAON,EAGT,MAAM,IAAIO,MAAM,+BAGlB,UCpLe,MAAMC,EACnBC,YAAYC,GACVC,KAAKD,QAAUA,EACfC,KAAKC,YAAa,EAGpBC,cACE,IAAIC,EAAO,GAEX,GACEC,OAAOC,kBACiCC,IAAxCF,OAAOC,YAAYE,iBAEnBJ,EAAKK,UAAYJ,OAAOC,YAAYE,iBAAiB,YACrDJ,EAAKM,MAAQL,OAAOC,YAAYE,iBAAiB,QACjDJ,EAAKO,SAAWN,OAAOC,YAAYE,iBAAiB,eAC/C,KACLH,OAAOC,kBACuCC,IAA9CF,OAAOC,YAAYM,uBAOnB,OADAC,QAAQC,IAAI,+BACL,EALPV,EAAKK,UAAYJ,OAAOC,YAAYM,uBAAuB,YAC3DR,EAAKM,MAAQL,OAAOC,YAAYM,uBAAuB,QACvDR,EAAKO,SAAWN,OAAOC,YAAYM,uBAAuB,WAK5D,OAAIP,OAAOC,YAAYS,QACrBX,EAAKY,WAAaX,OAAOC,YAAYS,OAKhCX,IAHLS,QAAQC,IAAI,+BACL,GAMXG,iBAAiBb,GACfA,EAAKc,iBAAmBd,EAAKK,UAAUU,KAAI,CAACC,EAAO9D,EAAGoB,KAGpD,IAAI2C,EAAcC,EAAexE,EADgB,IAA/BsE,EAAMG,KAAKzD,QAAQ,SAInCuD,EAAeD,EAAMG,KAAKC,MAAM,+BAChCF,EAAgBD,EAAa,GAAG5D,MAAM,KAAKgE,MAC3C3E,EAAgBwE,EAAchD,QAC3Bf,KAAKmE,IAAI,EAAGJ,EAAcK,YAAY,OAASC,EAAAA,GAAY,KAG9DP,EAAe,CAAC,GAAIQ,SAASC,MAC7BhF,EAAgBsE,EAAMG,KAAK9D,MAAM,KAAK,IAGxC,MAAMsE,EAAU,CACdR,KAAMH,EAAMG,KACZS,OAAQX,EAAa,GACrBtE,cACEqE,EAAMrE,eAAiBD,GAAiB,2BAC1CA,cAAeA,GAAiB,qBAChCmF,SAAUb,EAAMc,SAChBC,SAAUtF,EAAAA,YAAmBC,EAAesE,EAAMrE,eAClDqF,gBAAiBf,EAAa,KAAOQ,SAASC,MAGhD,IAAK,IAAIlC,KAAQwB,EACY,mBAAhBA,EAAMxB,KACfmC,EAAQnC,GAAQwB,EAAMxB,IAe1B,OAXIwB,EAAMiB,eACRN,EAAQO,kBAAoBlB,EAAMiB,aAAejB,EAAMmB,UACvDR,EAAQS,IAAMpB,EAAMqB,gBAAkBrB,EAAMsB,kBAC5CX,EAAQY,IAAMvB,EAAMwB,WAAaxB,EAAMyB,aACvCd,EAAQe,KAAO1B,EAAM2B,cAAgB3B,EAAMmB,UAC3CR,EAAQiB,gBAAkB5B,EAAM2B,cAAgB3B,EAAMiB,cAEpDjB,EAAM6B,wBACRlB,EAAQmB,IAAM9B,EAAMwB,WAAaxB,EAAM6B,uBAGlClB,KAIXoB,iBAAiB/C,GAEfA,EAAKgD,aAAehD,EAAKc,iBAAiBmC,QAAQjC,GACV,IAA/BA,EAAMG,KAAKzD,QAAQ,UAAkBsD,EAAMG,KAAKC,MAAM,aAI/DpB,EAAKkD,oBAAsBzG,EAAAA,aACzBuD,EAAKgD,aAAajC,KAAI,CAACC,EAAO9D,EAAGoB,IACxB0C,EAAMrE,eAAiBqE,EAAMtE,gBAEtC,iBAGFsD,EAAKmD,0BAA4B1G,EAAAA,aAC/BuD,EAAKgD,aAAajC,KAAI,CAACC,EAAO9D,EAAGoB,KAE5B0C,EAAMrE,eAAiBqE,EAAMtE,eAC9B,KACCsE,EAAMgB,gBAAkB,SAAW,gBAGxC,iBAGFhC,EAAKoD,iBAAmB3G,EAAAA,aACtBuD,EAAKgD,aAAajC,KAAI,CAACC,EAAO9D,EAAGoB,IAAQ0C,EAAMY,SAC/C,UAGF5B,EAAKqD,qBAAuB5G,EAAAA,aAC1BuD,EAAKgD,aAAajC,KAAI,CAACC,EAAO9D,EAAGoB,IAE7B0C,EAAMe,SACN,KACCf,EAAMgB,gBAAkB,SAAW,gBAGxC,YAGFhC,EAAKsD,eAAiB7G,EAAAA,aACpBuD,EAAKgD,aAAajC,KAAI,CAACC,EAAO9D,EAAGoB,IAAQ0C,EAAMe,WAC/C,YAGF,MAAMwB,EAAkB,GAExBvD,EAAKgD,aAAatE,SAASsC,IACzB,MAAMwC,EACJxD,EAAKoD,iBAAiBH,QAAQlE,GAAMA,EAAE6C,QAAUZ,EAAMY,SAAQ,IAAM,GAEhE6B,EAAkBF,EAAgBvC,EAAMY,SAAW,EAEzDZ,EAAMc,SAAW0B,EAAM1B,UAAYd,EAAM0C,YAAc1C,EAAMmB,UAEzDsB,GAAmBzC,EAAMmB,UAC3BqB,EAAMG,uBACHH,EAAMG,uBAAyB,GAAK3C,EAAMc,SACpC2B,EAAkBzC,EAAM0C,cACjCF,EAAMG,uBACHH,EAAMG,uBAAyB,IAC/B3C,EAAM0C,YAAcD,IAEzBF,EAAgBvC,EAAMY,QAAUZ,EAAM0C,aAAe,EACrDF,EAAMI,eAAiBJ,EAAMI,eAAiB,GAAK5C,EAAMc,YAI3D9B,EAAK6D,aAAe7D,EAAKgD,aAAaC,QACnCrB,GAAWA,EAAOA,SAAWH,SAASC,OACvCnE,OAEFyC,EAAK8D,yBAA2B9D,EAAKgD,aAAaC,QAC/CrB,GACCA,EAAOA,OAAOvE,MAAM,KAAK0G,OAAO,GAAGC,KAAK,OACxCvC,SAASC,KAAKrE,MAAM,KAAK0G,OAAO,GAAGC,KAAK,OAC1CzG,OAEFyC,EAAKiE,uBAAyBjE,EAAKgD,aAAaC,QAC7CrB,IAAYnF,EAAAA,SAAgBmF,EAAOA,OAAQsC,SAAStC,UACrDrE,OAEFyC,EAAKmE,eAAiBnE,EAAKoD,iBAAiBH,QACzCrB,GACCnF,EAAAA,SACEmF,EAAOA,OACPH,SAASC,KAAKrE,MAAM,KAAK0G,OAAO,GAAGC,KAAK,OACrCpC,EAAOA,SAAWH,SAASC,OAClCnE,OAGJ6G,gBAAgBpE,GACdA,EAAKqE,aAAe,GACpBrE,EAAKsE,aAAUnE,EAEXH,EAAKc,iBAAiBvD,OAAS,IACjCyC,EAAKqE,aAAerE,EAAKc,iBACtBmC,QAAQlE,GAAMA,EAAEoC,OAASM,SAAS8C,OAClCzF,MAAK,CAACC,EAAGC,IAAMA,EAAE8C,SAAW/C,EAAE+C,WAEjC9B,EAAKsE,QAAUnH,KAAKC,MAClB4C,EAAKqE,aAAaG,aAAY,CAACzF,EAAGC,IACf,iBAAND,EACFA,EAAE+C,SAAW9C,EAAE8C,SAEjB/C,EAAIC,EAAE8C,WACV9B,EAAKqE,aAAa9G,SAK7BkH,oBAAoBzE,GAClB,MAAMmC,EAAYnC,EAAKY,WAAW8D,gBAC5BC,EAAiB,CACrBC,aACE5E,EAAKY,WAAWiE,aAAe7E,EAAKY,WAAW8D,gBACjDI,OAAQ,IAGV,IAAK,IAAIC,KAAY/E,EAAKY,WAEtBZ,EAAKY,WAAWmE,IACqB,iBAA9B/E,EAAKY,WAAWmE,KAEvBJ,EAAeI,GAAY/E,EAAKY,WAAWmE,GAAY5C,EACvDwC,EAAeG,OAAOjG,KAAK,CACzBsC,KAAM4D,EACN,YAAa/E,EAAKY,WAAWmE,GAAY5C,KAI/CwC,EAAeG,OAAOhG,MACpB,CAACC,EAAGC,KAAOD,EAAE,cAAgB,IAAMC,EAAE,cAAgB,KAEvDgB,EAAK2E,eAAiBA,EAGxBK,QAC8B,aAAxBd,SAASe,YACXpF,KAAKC,YAAa,EAClBG,OAAOiF,OAAS,KACVrF,KAAKC,aACPD,KAAKC,YAAa,EAClBD,KAAKsF,iBAITtF,KAAKC,YAAa,EAClBD,KAAKsF,cAITA,aACE,IAAInF,EAAOH,KAAKE,cAChBF,KAAK4E,oBAAoBzE,GACzBH,KAAKgB,iBAAiBb,GACtBH,KAAKkD,iBAAiB/C,GACtBH,KAAKuE,gBAAgBpE,GAErB,MAAMoF,EAAMvF,KAAKD,QAAQwF,IACzB,IAAI,WAAEC,GAAexF,KAAKD,QAAQM,YAE9BiF,EAAa,CACf7E,MAAON,EAAKM,MACZC,SAAUP,EAAKO,SACfoE,eAAgB3E,EAAK2E,eACrB7D,iBAAkBd,EAAKc,iBACvBkC,aAAchD,EAAKgD,aACnBE,oBAAqBlD,EAAKkD,oBAC1BC,0BAA2BnD,EAAKmD,0BAChCC,iBAAkBpD,EAAKoD,iBACvBC,qBAAsBrD,EAAKqD,qBAC3BC,eAAgBtD,EAAKsD,eACrBO,aAAc7D,EAAK6D,aACnBC,yBAA0B9D,EAAK8D,yBAC/BG,uBAAwBjE,EAAKiE,uBAC7BE,eAAgBnE,EAAKmE,eACrBE,aAAcrE,EAAKqE,aACnBC,QAAStE,EAAKsE,SAEhB7D,QAAQC,IAAIyE,GACRhI,KAAKG,SAAW+H,GC/QT,SAAgBD,EAAKpF,GAC9BsF,UAAUC,WACZD,UAAUC,WAAWH,EAAKpF,GAE1BwF,MAAMJ,EAAK,CACTK,KAAMC,KAAKC,UAAU3F,GACrB4F,MAAO,WACPC,YAAa,UACbC,QAAS,CACP,eAAgB,mBAChBC,WAAY,cAEdC,OAAQ,OACRC,KAAM,OACNC,SAAU,WDkQVC,CAAOf,EAAKD,IE9QlB,MAAMiB,EACJzG,YAAY0G,GACV,IAAKA,EAAOjB,IACV,MAAM,IAAI3F,MAAM,gBAElBI,KAAKD,QAAU/D,OAAOyK,OACpB,CACElB,IAAK,GACLlF,YAAa,CACXmF,WAAY,GAEdkB,MAAO,GACPC,MAAO,IAETH,GAIJrB,QACMnF,KAAKD,QAAQM,aACf,IAAIR,EAAYG,KAAKD,SAASoF,MAAMnF,KAAKD,U","sources":["webpack://ostrichjs/webpack/bootstrap","webpack://ostrichjs/webpack/runtime/define property getters","webpack://ostrichjs/webpack/runtime/hasOwnProperty shorthand","webpack://ostrichjs/webpack/runtime/make namespace object","webpack://ostrichjs/./src/helpers.js","webpack://ostrichjs/./src/performance.js","webpack://ostrichjs/./src/reporter.js","webpack://ostrichjs/./src/index.js"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","/*\nMisc helpers\n*/\n\nconst helper = {};\n\n//extract a resources file type\nhelper.getFileType = (fileExtension, initiatorType) => {\n  if (fileExtension) {\n    switch (fileExtension) {\n      case \"jpg\":\n      case \"jpeg\":\n      case \"png\":\n      case \"gif\":\n      case \"webp\":\n      case \"svg\":\n      case \"ico\":\n        return \"image\";\n      case \"js\":\n        return \"js\";\n      case \"css\":\n        return \"css\";\n      case \"html\":\n        return \"html\";\n      case \"woff\":\n      case \"woff2\":\n      case \"ttf\":\n      case \"eot\":\n      case \"otf\":\n        return \"font\";\n      case \"swf\":\n        return \"flash\";\n      case \"map\":\n        return \"source-map\";\n    }\n  }\n  if (initiatorType) {\n    switch (initiatorType) {\n      case \"xmlhttprequest\":\n        return \"ajax\";\n      case \"img\":\n        return \"image\";\n      case \"script\":\n        return \"js\";\n      case \"internal\":\n      case \"iframe\":\n        return \"html\"; //actual page\n      default:\n        return \"other\";\n    }\n  }\n  return initiatorType;\n};\n\nhelper.getRandomColor = (baseRangeRed, baseRangeGreen, baseRangeBlue) => {\n  const range = [\n    baseRangeRed || \"0123456789ABCDEF\",\n    baseRangeGreen || \"0123456789ABCDEF\",\n    baseRangeBlue || \"0123456789ABCDEF\",\n  ];\n  let color = \"#\",\n    r = 0;\n\n  for (let i = 0; i < 6; i++) {\n    r = Math.floor(i / 2);\n    color += range[r].split(\"\")[Math.floor(Math.random() * range[r].length)];\n  }\n  return color;\n};\n\nhelper.endsWith = (str, suffix) => {\n  return str.indexOf(suffix, str.length - suffix.length) !== -1;\n};\n\nconst getColourVariation = (hexColour, variation) => {\n  const r = (parseInt(hexColour.substr(1, 2), 16) + variation).toString(16),\n    g = (parseInt(hexColour.substr(3, 2), 16) + variation).toString(16),\n    b = (parseInt(hexColour.substr(5, 2), 16) + variation).toString(16);\n  return \"#\" + r + g + b;\n};\n\nhelper.getInitiatorOrFileTypeColour = (\n  initiatorOrFileType,\n  fallbackColour,\n  variation\n) => {\n  let colour = fallbackColour || \"#bebebe\"; //default\n\n  //colour the resources by initiator or file type\n  switch (initiatorOrFileType) {\n    case \"css\":\n      colour = \"#afd899\";\n      break;\n    case \"iframe\":\n    case \"html\":\n      colour = \"#85b3f2\";\n      break;\n    case \"img\":\n    case \"image\":\n      colour = \"#bc9dd6\";\n      break;\n    case \"script\":\n    case \"js\":\n      colour = \"#e7bd8c\";\n      break;\n    case \"link\":\n      colour = \"#89afe6\";\n      break;\n    case \"swf\":\n      colour = \"#4db3ba\";\n      break;\n    case \"font\":\n      colour = \"#e96859\";\n      break; //TODO check if this works\n    case \"xmlhttprequest\":\n    case \"ajax\":\n      colour = \"#e7d98c\";\n      break;\n  }\n  if (variation === true) {\n    return getColourVariation(colour, -5);\n  }\n  return colour;\n};\n\n//counts occurrences of items in array arr and returns them as array of key valure pairs\n//keyName overwrites the name of the key attribute\nhelper.getItemCount = (arr, keyName) => {\n  let counts = {},\n    resultArr = [],\n    obj;\n\n  arr.forEach((key) => {\n    counts[key] = counts[key] ? counts[key] + 1 : 1;\n  });\n\n  //pivot data\n  for (let fe in counts) {\n    obj = {};\n    obj[keyName || \"key\"] = fe;\n    obj.count = counts[fe];\n\n    resultArr.push(obj);\n  }\n  return resultArr.sort((a, b) => {\n    return a.count < b.count ? 1 : -1;\n  });\n};\n\nhelper.clone = (obj) => {\n  let copy;\n\n  // Handle the 3 simple types, and null or undefined\n  if (null == obj || \"object\" != typeof obj) return obj;\n\n  // Handle Date\n  if (obj instanceof Date) {\n    copy = new Date();\n    copy.setTime(obj.getTime());\n    return copy;\n  }\n\n  // Handle Array\n  if (obj instanceof Array) {\n    copy = [];\n    for (let i = 0, len = obj.length; i < len; i++) {\n      copy[i] = helper.clone(obj[i]);\n    }\n    return copy;\n  }\n\n  // Handle Object\n  if (obj instanceof Object) {\n    copy = {};\n    for (let attr in obj) {\n      if (obj.hasOwnProperty(attr)) copy[attr] = helper.clone(obj[attr]);\n    }\n    return copy;\n  }\n\n  throw new Error(\"Unable to helper.clone obj\");\n};\n\nexport default helper;\n","import report from \"./reporter\";\nimport helper from \"./helpers\";\n\nexport default class Performance {\n  constructor(options) {\n    this.options = options;\n    this.waitToSend = false;\n  }\n\n  extractData() {\n    let data = {};\n    //Check if the browser suppots the timing APIs\n    if (\n      window.performance &&\n      window.performance.getEntriesByType !== undefined\n    ) {\n      data.resources = window.performance.getEntriesByType(\"resource\");\n      data.marks = window.performance.getEntriesByType(\"mark\");\n      data.measures = window.performance.getEntriesByType(\"measure\");\n    } else if (\n      window.performance &&\n      window.performance.webkitGetEntriesByType !== undefined\n    ) {\n      data.resources = window.performance.webkitGetEntriesByType(\"resource\");\n      data.marks = window.performance.webkitGetEntriesByType(\"mark\");\n      data.measures = window.performance.webkitGetEntriesByType(\"measure\");\n    } else {\n      console.log(\"您的浏览器不支持window performance\");\n      return false;\n    }\n    if (window.performance.timing) {\n      data.perfTiming = window.performance.timing;\n    } else {\n      console.log(\"您的浏览器不支持performance timing\");\n      return false;\n    }\n    return data;\n  }\n\n  //resource计算\n  caculateResource(data) {\n    data.allResourcesCalc = data.resources.map((currR, i, arr) => {\n      //crunch the resources data into something easier to work with\n      const isRequest = currR.name.indexOf(\"http\") === 0;\n      let urlFragments, maybeFileName, fileExtension;\n\n      if (isRequest) {\n        urlFragments = currR.name.match(/:\\/\\/(.[^/]+)([^?]*)\\??(.*)/);\n        maybeFileName = urlFragments[2].split(\"/\").pop();\n        fileExtension = maybeFileName.substr(\n          (Math.max(0, maybeFileName.lastIndexOf(\".\")) || Infinity) + 1\n        );\n      } else {\n        urlFragments = [\"\", location.host];\n        fileExtension = currR.name.split(\":\")[0];\n      }\n\n      const currRes = {\n        name: currR.name,\n        domain: urlFragments[1],\n        initiatorType:\n          currR.initiatorType || fileExtension || \"SourceMap or Not Defined\",\n        fileExtension: fileExtension || \"XHR or Not Defined\",\n        loadtime: currR.duration,\n        fileType: helper.getFileType(fileExtension, currR.initiatorType),\n        isRequestToHost: urlFragments[1] === location.host,\n      };\n\n      for (let attr in currR) {\n        if (typeof currR[attr] !== \"function\") {\n          currRes[attr] = currR[attr];\n        }\n      }\n\n      if (currR.requestStart) {\n        currRes.requestStartDelay = currR.requestStart - currR.startTime;\n        currRes.dns = currR.domainLookupEnd - currR.domainLookupStart;\n        currRes.tcp = currR.connectEnd - currR.connectStart;\n        currRes.ttfb = currR.responseStart - currR.startTime;\n        currRes.requestDuration = currR.responseStart - currR.requestStart;\n      }\n      if (currR.secureConnectionStart) {\n        currRes.ssl = currR.connectEnd - currR.secureConnectionStart;\n      }\n\n      return currRes;\n    });\n  }\n\n  calculateRequest(data) {\n    //filter out non-http[s] and sourcemaps\n    data.requestsOnly = data.allResourcesCalc.filter((currR) => {\n      return currR.name.indexOf(\"http\") === 0 && !currR.name.match(/js.map$/);\n    });\n\n    //get counts\n    data.initiatorTypeCounts = helper.getItemCount(\n      data.requestsOnly.map((currR, i, arr) => {\n        return currR.initiatorType || currR.fileExtension;\n      }),\n      \"initiatorType\"\n    );\n\n    data.initiatorTypeCountHostExt = helper.getItemCount(\n      data.requestsOnly.map((currR, i, arr) => {\n        return (\n          (currR.initiatorType || currR.fileExtension) +\n          \" \" +\n          (currR.isRequestToHost ? \"(host)\" : \"(external)\")\n        );\n      }),\n      \"initiatorType\"\n    );\n\n    data.requestsByDomain = helper.getItemCount(\n      data.requestsOnly.map((currR, i, arr) => currR.domain),\n      \"domain\"\n    );\n\n    data.fileTypeCountHostExt = helper.getItemCount(\n      data.requestsOnly.map((currR, i, arr) => {\n        return (\n          currR.fileType +\n          \" \" +\n          (currR.isRequestToHost ? \"(host)\" : \"(external)\")\n        );\n      }),\n      \"fileType\"\n    );\n\n    data.fileTypeCounts = helper.getItemCount(\n      data.requestsOnly.map((currR, i, arr) => currR.fileType),\n      \"fileType\"\n    );\n\n    const tempResponseEnd = {};\n    //TODO: make immutable\n    data.requestsOnly.forEach((currR) => {\n      const entry =\n        data.requestsByDomain.filter((a) => a.domain == currR.domain)[0] || {};\n\n      const lastResponseEnd = tempResponseEnd[currR.domain] || 0;\n\n      currR.duration = entry.duration || currR.responseEnd - currR.startTime;\n\n      if (lastResponseEnd <= currR.startTime) {\n        entry.durationTotalParallel =\n          (entry.durationTotalParallel || 0) + currR.duration;\n      } else if (lastResponseEnd < currR.responseEnd) {\n        entry.durationTotalParallel =\n          (entry.durationTotalParallel || 0) +\n          (currR.responseEnd - lastResponseEnd);\n      }\n      tempResponseEnd[currR.domain] = currR.responseEnd || 0;\n      entry.durationTotal = (entry.durationTotal || 0) + currR.duration;\n    });\n\n    //Request counts\n    data.hostRequests = data.requestsOnly.filter(\n      (domain) => domain.domain === location.host\n    ).length;\n\n    data.currAndSubdomainRequests = data.requestsOnly.filter(\n      (domain) =>\n        domain.domain.split(\".\").slice(-2).join(\".\") ===\n        location.host.split(\".\").slice(-2).join(\".\")\n    ).length;\n\n    data.crossDocDomainRequests = data.requestsOnly.filter(\n      (domain) => !helper.endsWith(domain.domain, document.domain)\n    ).length;\n\n    data.hostSubdomains = data.requestsByDomain.filter(\n      (domain) =>\n        helper.endsWith(\n          domain.domain,\n          location.host.split(\".\").slice(-2).join(\".\")\n        ) && domain.domain !== location.host\n    ).length;\n  }\n\n  caculateSlowest(data) {\n    data.slowestCalls = [];\n    data.average = undefined;\n\n    if (data.allResourcesCalc.length > 0) {\n      data.slowestCalls = data.allResourcesCalc\n        .filter((a) => a.name !== location.href)\n        .sort((a, b) => b.duration - a.duration);\n\n      data.average = Math.floor(\n        data.slowestCalls.reduceRight((a, b) => {\n          if (typeof a !== \"number\") {\n            return a.duration + b.duration;\n          }\n          return a + b.duration;\n        }) / data.slowestCalls.length\n      );\n    }\n  }\n\n  calculatePerfTiming(data) {\n    const startTime = data.perfTiming.navigationStart;\n    const perfTimingCalc = {\n      pageLoadTime:\n        data.perfTiming.loadEventEnd - data.perfTiming.navigationStart,\n      output: [],\n    };\n\n    for (let perfProp in data.perfTiming) {\n      if (\n        data.perfTiming[perfProp] &&\n        typeof data.perfTiming[perfProp] === \"number\"\n      ) {\n        perfTimingCalc[perfProp] = data.perfTiming[perfProp] - startTime;\n        perfTimingCalc.output.push({\n          name: perfProp,\n          \"time (ms)\": data.perfTiming[perfProp] - startTime,\n        });\n      }\n    }\n    perfTimingCalc.output.sort(\n      (a, b) => (a[\"time (ms)\"] || 0) - (b[\"time (ms)\"] || 0)\n    );\n    data.perfTimingCalc = perfTimingCalc;\n  }\n\n  start() {\n    if (document.readyState !== \"complete\") {\n      this.waitToSend = true;\n      window.onload = () => {\n        if (this.waitToSend) {\n          this.waitToSend = false;\n          this.reportData();\n        }\n      };\n    } else {\n      this.waitToSend = false;\n      this.reportData();\n    }\n  }\n\n  reportData() {\n    let data = this.extractData();\n    this.calculatePerfTiming(data);\n    this.caculateResource(data);\n    this.calculateRequest(data);\n    this.caculateSlowest(data);\n\n    const url = this.options.url;\n    let { sampleRate } = this.options.performance;\n\n    let reportData = {\n      marks: data.marks,\n      measures: data.measures,\n      perfTimingCalc: data.perfTimingCalc,\n      allResourcesCalc: data.allResourcesCalc,\n      requestsOnly: data.requestsOnly,\n      initiatorTypeCounts: data.initiatorTypeCounts,\n      initiatorTypeCountHostExt: data.initiatorTypeCountHostExt,\n      requestsByDomain: data.requestsByDomain,\n      fileTypeCountHostExt: data.fileTypeCountHostExt,\n      fileTypeCounts: data.fileTypeCounts,\n      hostRequests: data.hostRequests,\n      currAndSubdomainRequests: data.currAndSubdomainRequests,\n      crossDocDomainRequests: data.crossDocDomainRequests,\n      hostSubdomains: data.hostSubdomains,\n      slowestCalls: data.slowestCalls,\n      average: data.average,\n    };\n    console.log(reportData);\n    if (Math.random() < sampleRate) {\n      report(url, reportData);\n    }\n  }\n}\n","export default function report(url, data) {\n  if (navigator.sendBeacon) {\n    navigator.sendBeacon(url, data);\n  } else {\n    fetch(url, {\n      body: JSON.stringify(data), // must match 'Content-Type' header\n      cache: \"no-cache\", // *default, no-cache, reload, force-cache, only-if-cached\n      credentials: \"include\", // include, same-origin, *omit\n      headers: {\n        \"content-type\": \"application/json\",\n        connection: \"keep-alive\",\n      },\n      method: \"POST\", // *GET, POST, PUT, DELETE, etc.\n      mode: \"cors\", // no-cors, cors, *same-origin\n      referrer: \"client\", // *client, no-referrer\n    });\n  }\n}\n","import Performance from \"./performance.js\";\n\nclass Ostrich {\n  constructor(option) {\n    if (!option.url) {\n      throw new Error(\"参数数据，url为必填项\");\n    }\n    this.options = Object.assign(\n      {\n        url: \"\",\n        performance: {\n          sampleRate: 1,\n        },\n        error: {},\n        event: {},\n      },\n      option\n    );\n  }\n\n  start() {\n    if (this.options.performance) {\n      new Performance(this.options).start(this.options);\n    }\n  }\n}\n\nexport { Ostrich };\n"],"names":["__webpack_require__","exports","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","Symbol","toStringTag","value","helper","fileExtension","initiatorType","baseRangeRed","baseRangeGreen","baseRangeBlue","range","color","r","i","Math","floor","split","random","length","str","suffix","indexOf","getInitiatorOrFileTypeColour","initiatorOrFileType","fallbackColour","variation","colour","hexColour","parseInt","substr","toString","getColourVariation","getItemCount","arr","keyName","counts","resultArr","forEach","fe","count","push","sort","a","b","clone","copy","Date","setTime","getTime","Array","len","attr","Error","Performance","constructor","options","this","waitToSend","extractData","data","window","performance","undefined","getEntriesByType","resources","marks","measures","webkitGetEntriesByType","console","log","timing","perfTiming","caculateResource","allResourcesCalc","map","currR","urlFragments","maybeFileName","name","match","pop","max","lastIndexOf","Infinity","location","host","currRes","domain","loadtime","duration","fileType","isRequestToHost","requestStart","requestStartDelay","startTime","dns","domainLookupEnd","domainLookupStart","tcp","connectEnd","connectStart","ttfb","responseStart","requestDuration","secureConnectionStart","ssl","calculateRequest","requestsOnly","filter","initiatorTypeCounts","initiatorTypeCountHostExt","requestsByDomain","fileTypeCountHostExt","fileTypeCounts","tempResponseEnd","entry","lastResponseEnd","responseEnd","durationTotalParallel","durationTotal","hostRequests","currAndSubdomainRequests","slice","join","crossDocDomainRequests","document","hostSubdomains","caculateSlowest","slowestCalls","average","href","reduceRight","calculatePerfTiming","navigationStart","perfTimingCalc","pageLoadTime","loadEventEnd","output","perfProp","start","readyState","onload","reportData","url","sampleRate","navigator","sendBeacon","fetch","body","JSON","stringify","cache","credentials","headers","connection","method","mode","referrer","report","Ostrich","option","assign","error","event"],"sourceRoot":""}